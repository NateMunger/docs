---
sidebar_position: 4
sidebar_label: Mailgun
title: Send Email Notifications Using Mailgun
description: Looking for a way to send email notifications via Mailgun? This step-by-step tutorial will show you how to integrate Mailgun's API the easy way.
---

import Image from "@theme/IdealImage";

# Mailgun

## Profile Requirements

To deliver a message to a recipient over Mailgun, Courier must be provided the recipient's email address. This value should be included in the recipient profile as `email`.

```json title=JSON
// Recipient Profile
{
  "email": "example@example.com"
}
```

## Override

You can use a provider override to replace what we send to Mailgun's Messages API. For example, you can use [Mailgun's Tagging](https://documentation.mailgun.com/en/latest/user_manual.html#tagging) with your request:

```json title=JSON
{
  "event": "ABCDEFGHIJKLMNOPQRSTUVWXYZ",
  "recipient": "abc123",
  "profile": {
    "email": "example@example.com"
  },
  "override": {
    "mailgun": {
      "body": {
        "o:tag": "notifications"
      },
      "config": {
        "apiKey": "<your API Key>",
        "domain": "<domain>",
        "host": "<host>"
      }
    }
  }
}
```

Everything inside of `override.mailgun` will replace what we send to Mailgun's Messages API. You can see all the available options by visiting [Mailgun API docs](https://documentation.mailgun.com/en/latest/api-sending.html).

## Sending Attachments

To include an attachment in the email, you can use the following override:

```json
{
  "event": "ABCDEFGHIJKLMNOPQRSTUVWXYZ",
  "recipient": "abc123",
  "profile": {
    "email": "example@example.com"
  },
  "data": {
    "hello": "world"
  },
  "override": {
    "mailgun": {
      "attachments": [
        {
          "filename": "billing.pdf",
          "contentType": "application/pdf",
          "data": "Q29uZ3JhdHVsYXRpb25zLCB5b3UgY2FuIGJhc2U2NCBkZWNvZGUh"
        }
      ]
    }
  }
}
```

## Setup mailhooks for delivery status updates

By default, after we send a message, Courier will poll Mailgun periodically to find out if the message was delivered successfully or not.
To get faster status updates, you can setup a mailhook so Mailgun can report delivery status directly to Courier.

To start, login to Courier and visit the Mailgun provider configuration screen (from the Channels menu on the left side). There, you will find a Webhook URL.

<Image img={require("../../../assets/guides/mailgun/courier-ui.png")} alt="" />

Copy this URL, then login to Mailgun. On the left side, choose Sending, then Webhooks.

<Image img={require("../../../assets/guides/mailgun/mailgun-ui.png")} alt="" />

On the webhooks screen, click the green "Add webhook" button on the right. For event type, choose "Delivered Messages". Now paste the webhook URL into the URL field and press "Create webhook."

<Image img={require("../../../assets/guides/mailgun/mailgun-form.png")} alt="" />

Repeat the process to create a webhook for event type "Permanent Failure." Use the same URL for both webhooks.

It takes Mailgun about a minute to start sending events to the webhooks. So, give it a minute or two, then go back to the Courier Mailgun configuration screen. Activate the toggle switch to "Disable polling for status updates." Now that webhooks are setup, you won't need polling anymore.
